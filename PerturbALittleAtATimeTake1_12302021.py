# coding: utf-8
from sympy import init_session
init_session(quiet=True)
w, W, r, R, m, M, dR, t, x, y, X1, Y1, X2, Y2, U12, U13, U23, K1, K2, K3, E= symbols('w W r R m M dR t x y X1 Y1 X2 Y2 U12 U13 U23 K1 K2 K3 E')
W=2*pi/sqrt(2*pi*R**3/M)
w=2*pi/sqrt(2*pi*r**3/m)
Wpert=W.subs(R,R+dR)
Wpert=Wpert.series(dR,0,2).removeO()
Wpert
Wpert/W
Simplify(Wpert/W)
simplify(Wpert/W)
cancel(Wpert/W)
Wpert*R^(-3/2)
Wpert*R**(-3/2)
Wpert
W
Wpert.subs(sqrt(2)*sqrt(pi)/sqrt(R**3)*sqrt(M),W)
Wpert/W
simplify Wpert/W
simplify(Wpert/W)
expand(Wpert/W)
cancel(expand(Wpert/W))
factor(expand(Wpert/W))
Wpert/W
factor(Wpert/W)
powersimp(factor(Wpert/W),force=True)
powsimp(factor(Wpert/W),force=True)
powsimp(powsimp(factor(Wpert/W),force=True),force=True)
powsimp(x**a/x**b, force=True)
powsimp(x**2/x**3, force=True)
powsimp(sqrt(x^3)/x^(5/2), force=True)
powsimp(sqrt(x**3)/x**(5/2), force=True)
powsimp(x**(3/2)/x^(5/2), force=True)
powsimp(x**(3/2)/x**(5/2), force=True)
powsimp(factor(Wpert/W),force=True)
Wrel = powsimp(factor(Wpert/W),force=True)
Wrel.subs(sqrt(R**3),R**(3/2))
Wre.subs(R**(1.0), R)
Wrel.subs(sqrt(R**3),R**(3/2)).subs(R**(1.0), R)
cancel(Wrel.subs(sqrt(R**3),R**(3/2)))
factor(cancel(Wrel.subs(sqrt(R**3),R**(3/2))))
Wrel.subs(sqrt(R**3),R**(3/2)).subs(1.0,1)
Wrel=Wrel.subs(sqrt(R**3),R**(3/2)).subs(1.0,1)
simplify(Wrel)
cancel(Wrel)
expand(Wrel)
Wrel=expand(Wrel)
Wprime=Wrel*W
Wprime
W0,w0=symbols('W0,wo')
Wprime=W0*Wrel
x=r*cos(w0*t)
y=r*sin(w0*t)
X1=R*cos(Wrel*t)
X2=-R*cos(Wrel*t)
Y1=R*sin(Wrel*t)
Y2=-R*sin(Wrel*t)
r12=2*R+2*dR
r13=sqrt((x-X1)**2+(y-Y1)**2)
r13
symbol w
w= symbols('w')
x=r*cos(w*t)
y=r*sin(w*t)
r13=sqrt((x-X1)**2+(y-Y1)**2)
r13
X1=R*cos(Wprime*t)
X2=-R*cos(Wprime*t)
X1
Y2=-R*sin(Wprime*t)
Y1=R*sin(Wprime*t)
r13=sqrt((x-X1)**2+(y-Y1)**2)
r13
r13sq=(x-X1)**2+(y-Y1)**2
r13sq
r13sqpert=r13sq.series(dR,0,2).removeO()
r13sqpert
cancel(r13sqpert)
r13sqpert=cancel(r13sqpert)
collect(r13sqpert,dR)
r13sqfirstorder=collect(r13sqpert,dR).coeff(dR,1)
r13sqfirstorder=collect(r13sqpert,dR)
r13sq0=r13sqfirstorder.coeff(dR,0)
r13sq1=r13sqfirstorder.coeff(dR,1)
r13sq0
r13sq1
trigsimp(r13sq0)
r13sq0=trigsimp(r13sq0)
r13sq1=trigsimp(r13sq1)
r13sq1
r13pert=sqrt(r13sq0+r13sq1*dR)
r13pert
r13pertdR=r13pert.subs(R,R+dR)
r13pertdR
r13nosqrtpert=r13pertdR.series(dR,0,2).removeO()
r13nosqrtpert
r13pert=(r13sq0+r13sq1*dR)**(1/2)
r13pertdR=r13pert.subs(R,R+dR)
r13pertdR
r13nosqrtpert=r13pertdR.series(dR,0,2).removeO()
r13nosqrtpert
cancel(r13nosqrtpert)
r13nosqrtpert2=cancel(r13nosqrtpert).subs(1.0,1)
r13nosqrtpert2
collect(r13nosqrtpert2,dR)
r13_0=collect(r13nosqrtpert2,dR).coeff(dR,0)
r13_1=collect(r13nosqrtpert2,dR).coeff(dR,1)
r13_0
r130=collect(r13nosqrtpert2,dR).coeff(dR,0)
r130
r130=collect(r13nosqrtpert2,dR)
r130
r130.coeff(dR,0)
r130.coeff(dR,1)
apart(r130)
r130.apart()
apart(r130,dR)
r130=apart(r130,dR)
r1301=r130.coeff(dR,1)
r1300=r130.coeff(dR,0)
get_ipython().run_line_magic('ls', '')
r1300
r1301
cancel(r1300)
cancel(r1301)
trigsimplify(cancel(r1301)
)
trigsimp(cancel(r1301)
)
trigsimp(cancel(r1301)
).subs(1.0,1)
r1300=cancel(r1300)
r1300
r1301=trigsimp(cancel(r1301)).subs(1.0,1)
r1301
r130=r1300+dR*r1301
r130
r12
r23
r23sq=(x-X2)**2+(y-Y2)**2
r23sq
r23sqpert=r23sq.subs(R,R+dR)
r23sqfo=r23sqpert.series(dR,0,2).removeO()
r23sqfo
r23sqfo0=r23sqfo.coeff(dR,0)
r23sfo1=r23sqfo.coeff(dR,1)
r23sqfo0
trigsimp(r23sqfo0)
r23sqfo0=trigsimp(r23sqfo0)
r1300
r23sqfo1=trigsimp(r23sqfo1)
r23sqfo1=trigsimp(r23sfo1)
r23sqfo1
r23sqfo=r23sqfo0+dR*r23sqfo1
r23sqfo
r23pert=sqrt(r23sqfo).subs(R,dR)
r23pert
r23fo=r23pert.series(dR,0,2).removeO()
r23fo
r23pert=(r23sqfo**(1/2)).subs(R,dR)
r23pert
r23fo=r23pert.series(dR,0,2).removeO()
r23fo
r23pert=sqrt(r23sqfo).subs(R,R+dR)
r23pert
r23fo=r23pert.series(dR,0,2).removeO()
r23fo
r23fo0=r23fo.coeff(dR,0)
r23fo1=r23fo.coeff(dR,1)
r23fo0
r23fo1
cancel(r23fo1)
r230=r23fo0+r23fo1*dR
U12
r230
r23fo0
r23fo1
simplify(r23fo1)
r23fo1=simplify(r23fo1)
r230=r23fo0+dR*r23fo1
r230
r130
